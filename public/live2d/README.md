# Live2D 集成说明

## 项目概述

本项目在 N.E.K.O.-RN 中集成了 Live2D 虚拟角色功能，提供了一个完整的 Live2D 展示和交互界面。

## 功能特性

### ✨ 主要功能
- **多模型支持**: 支持NEKO助手、虚拟偶像、动漫角色等多种Live2D模型
- **实时交互**: 触摸互动、动画播放、表情变化
- **智能加载**: 模型异步加载，支持加载状态和错误处理
- **响应式设计**: 适配不同屏幕尺寸和主题模式
- **丰富设置**: 音量、显示质量、互动方式等可自定义设置

### 🎯 核心组件

#### 1. Live2DViewer 组件 (`/components/live2d-viewer.tsx`)
- 负责 Live2D 模型的加载和渲染
- 处理触摸交互和动画播放
- 提供状态管理和错误处理

#### 2. Live2D 页面 (`/app/(tabs)/live2d.tsx`)
- 主要的 Live2D 交互界面
- 模型选择和切换功能
- 互动控制面板
- 设置选项管理

## 使用方法

### 基本使用

1. **启动应用**: 运行 `npm start` 启动 Expo 开发服务器
2. **访问Live2D**: 点击底部 "Live2D" 标签页
3. **选择模型**: 从模型卡片中选择想要加载的Live2D角色
4. **开始互动**: 模型加载完成后，使用互动按钮与角色交互

### 模型配置

模型配置文件位于 `/assets/live2d/models.json`，包含：

```json
{
  "models": [
    {
      "id": "模型ID",
      "name": "显示名称", 
      "description": "模型描述",
      "modelPath": "模型文件路径",
      "animations": [...],
      "expressions": [...],
      "settings": {...}
    }
  ]
}
```

### 支持的交互

- **打招呼**: 播放问候动画
- **跳舞**: 播放舞蹈动画  
- **说话**: 播放对话动画
- **表情**: 切换角色表情
- **触摸**: 点击模型触发随机反应

## 技术实现

### 架构设计

```
Live2D页面
├── Live2DViewer组件
│   ├── 模型加载管理
│   ├── Canvas渲染区域
│   ├── 触摸事件处理
│   └── 状态指示器
├── 模型选择界面
├── 互动控制面板
└── 设置选项面板
```

### 状态管理

- **加载状态**: 模型加载进度和完成状态
- **错误处理**: 网络错误、模型格式错误等异常情况
- **交互状态**: 当前模型、动画播放状态等

### 响应式设计

- 支持 iOS/Android/Web 多平台
- 深色/浅色主题自动切换
- 不同屏幕尺寸自适应布局

## 扩展开发

### 添加新模型

1. 准备 Live2D 模型文件（.model3.json, .moc3, .physics3.json 等）
2. 在 `models.json` 中添加模型配置
3. 更新模型选择界面的模型列表

### 自定义动画

```typescript
const triggerAnimation = (animationName: string) => {
  // 调用 Live2D SDK 播放指定动画
  live2dModel.startMotion('motion', animationName);
};
```

### 添加新交互

```typescript
const handleCustomInteraction = () => {
  // 实现自定义交互逻辑
  triggerAnimation('custom_animation');
  // 可以添加音效、粒子效果等
};
```

## 性能优化

### 内存管理
- 模型切换时自动释放上一个模型的资源
- 纹理资源的复用和缓存
- 动画缓存和预加载

### 渲染优化  
- 60FPS 流畅渲染
- 视口裁剪优化
- LOD（细节层次）支持

## 依赖说明

### 核心依赖
- `react-native`: React Native 框架
- `expo`: Expo 开发平台
- `react-native-reanimated`: 动画库

### Live2D 相关
- 真实项目中需要集成 Live2D Cubism SDK
- WebGL 渲染支持
- 音频播放库（用于语音交互）

## 开发注意事项

1. **模型文件**: Live2D 模型文件较大，建议使用 CDN 或本地资源优化
2. **性能监控**: 定期检查内存使用和渲染性能
3. **错误处理**: 完善的错误处理和用户反馈机制
4. **测试**: 在不同设备上测试兼容性和性能

## 未来扩展

- [ ] 语音识别和TTS集成
- [ ] AR/VR 支持
- [ ] 多角色同屏互动
- [ ] 社交分享功能
- [ ] 自定义角色创建工具

---

*Live2D 技术由 Live2D Inc. 提供，本项目仅为展示集成方案*
